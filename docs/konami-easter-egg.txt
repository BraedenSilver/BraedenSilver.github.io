Konami Easter Egg (Archived)
============================

The JavaScript and CSS below previously powered the Konami code Easter egg on
BraedenSilver.com. Keep this file around so we can revive or remix the feature
later without digging through history.

JavaScript (from `js/site.js`):
--------------------------------

function initKonamiCode() {
  const sequence = [
    "arrowup",
    "arrowup",
    "arrowdown",
    "arrowdown",
    "arrowleft",
    "arrowright",
    "arrowleft",
    "arrowright",
    "b",
    "a",
  ];

  const buffer = [];
  let previousFocus = null;

  const removeOverlay = () => {
    const overlay = document.getElementById("konami-overlay");
    if (!overlay) return;
    overlay.remove();
    document.body.classList.remove("konami-active");
    if (previousFocus && typeof previousFocus.focus === "function") {
      previousFocus.focus();
    }
    previousFocus = null;
    buffer.length = 0;
  };

  const spawnOverlay = () => {
    if (document.getElementById("konami-overlay")) return;

    previousFocus =
      document.activeElement instanceof HTMLElement
        ? document.activeElement
        : null;

    const overlay = document.createElement("div");
    overlay.id = "konami-overlay";
    overlay.className = "konami-overlay";
    overlay.setAttribute("role", "dialog");
    overlay.setAttribute("aria-modal", "true");
    overlay.setAttribute("aria-labelledby", "konami-title");

    const panel = document.createElement("div");
    panel.className = "konami-panel";
    panel.addEventListener("click", (event) => event.stopPropagation());

    const title = document.createElement("h2");
    title.id = "konami-title";
    title.textContent = "Secret Video Unlocked";

    const intro = document.createElement("p");
    intro.textContent = "Enjoy a tune unlocked by the Konami code.";

    const videoWrap = document.createElement("div");
    videoWrap.className = "konami-video";

    const video = document.createElement("iframe");
    video.src = "https://www.youtube.com/embed/5IsSpAOD6K8?autoplay=1&start=12";
    video.title = "Talking Heads â€” Once in a Lifetime";
    video.allow =
      "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
    video.allowFullscreen = true;
    video.loading = "lazy";
    video.referrerPolicy = "strict-origin-when-cross-origin";
    videoWrap.appendChild(video);

    const actions = document.createElement("div");
    actions.className = "konami-actions";

    const close = document.createElement("button");
    close.type = "button";
    close.className = "konami-action konami-close";
    close.textContent = "Exit video";
    close.addEventListener("click", removeOverlay);
    actions.appendChild(close);

    panel.appendChild(title);
    panel.appendChild(intro);
    panel.appendChild(videoWrap);
    panel.appendChild(actions);

    overlay.appendChild(panel);

    const getFocusableButtons = () =>
      Array.from(panel.querySelectorAll("button:not([disabled])"));

    overlay.addEventListener("keydown", (event) => {
      if (event.key !== "Tab") return;
      event.preventDefault();
      const focusable = getFocusableButtons();
      if (!focusable.length) return;
      const currentIndex = focusable.indexOf(document.activeElement);
      let nextIndex = currentIndex;
      if (currentIndex === -1) {
        nextIndex = 0;
      } else if (event.shiftKey) {
        nextIndex = (currentIndex - 1 + focusable.length) % focusable.length;
      } else {
        nextIndex = (currentIndex + 1) % focusable.length;
      }
      focusable[nextIndex].focus();
    });
    overlay.addEventListener("focusin", (event) => {
      const focusable = getFocusableButtons();
      if (!focusable.length) return;
      if (!focusable.includes(event.target)) {
        focusable[0].focus();
      }
    });
    overlay.addEventListener("click", removeOverlay);

    document.body.appendChild(overlay);
    document.body.classList.add("konami-active");
    buffer.length = 0;

    requestAnimationFrame(() => {
      const focusable = getFocusableButtons();
      if (focusable.length) {
        focusable[0].focus();
      } else {
        close.focus();
      }
    });
  };

  document.addEventListener("keydown", (event) => {
    if (event.metaKey || event.ctrlKey || event.altKey) return;

    const target = event.target;
    if (
      target instanceof HTMLElement &&
      (target.isContentEditable ||
        ["INPUT", "TEXTAREA"].includes(target.tagName) ||
        target.getAttribute("role") === "textbox")
    ) {
      return;
    }

    if (
      event.key === "Escape" &&
      document.body.classList.contains("konami-active")
    ) {
      event.preventDefault();
      removeOverlay();
      return;
    }

    const key =
      event.key.length === 1
        ? event.key.toLowerCase()
        : event.key.toLowerCase();
    buffer.push(key);
    if (buffer.length > sequence.length) {
      buffer.shift();
    }

    if (
      buffer.length === sequence.length &&
      sequence.every((expected, index) => buffer[index] === expected)
    ) {
      spawnOverlay();
    }
  });
}

CSS (from `assets/site.css`):
-----------------------------

body.konami-active {
  overflow: hidden;
}

.konami-overlay {
  position: fixed;
  inset: 0;
  background: rgba(8, 7, 19, 0.94);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: clamp(1.5rem, 4vw, 3rem);
  z-index: 11000;
}

.konami-panel {
  background: #141129;
  color: #fefcf6;
  border: 3px solid #f8d948;
  border-radius: 20px;
  max-width: min(680px, 92vw);
  width: 100%;
  padding: clamp(1.75rem, 5vw, 2.5rem);
  box-shadow: 0 18px 60px rgba(0, 0, 0, 0.55);
  text-align: center;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.konami-panel h2 {
  margin: 0;
  font-size: clamp(1.5rem, 4vw, 2.2rem);
}

.konami-panel p {
  margin: 0;
  line-height: 1.6;
}

.konami-video {
  position: relative;
  width: 100%;
  aspect-ratio: 16 / 9;
  background: var(--color-strong-bg);
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
  border: 1px solid rgba(255, 255, 255, 0.25);
}

.konami-video iframe {
  width: 100%;
  height: 100%;
  border: 0;
}

.konami-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  justify-content: center;
  margin-top: 1.5rem;
}

.konami-action {
  align-self: center;
  border: 2px solid #fefcf6;
  background: transparent;
  color: inherit;
  font-weight: 700;
  padding: 0.5rem 1.6rem;
  border-radius: 999px;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease,
    color 0.2s ease;
  box-shadow: 4px 4px 0 rgba(0, 0, 0, 0.45);
}

.konami-action:hover,
.konami-action:focus-visible {
  transform: translate(-2px, -2px);
  background: #fefcf6;
  color: #141129;
}

.konami-action[disabled] {
  opacity: 0.6;
  cursor: not-allowed;
}
